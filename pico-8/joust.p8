pico-8 cartridge // http://www.pico-8.com
version 16
__lua__
--joust
--brennan rodriguez


mode = 0
--0 = menu, 1 is play
--2 is p1 victory
--3 is p2 victory
msg = false

players = {}


function _init()
local	p1 = {}
local	p2 = {}
	p1.spr = 1
	p1.x = 0
	p1.y = 63
	p1.score = 0

	p2.spr = 2
	p2.x = 119
	p2.y = 63
	p2.score = 0
	add(players,p1)
	add(players,p2)

	speed = 0.5
	menuitem(1,"reset game",reset)
end


function _update()
	local p1 = getp1()
	local p2 = getp2()
	--main menu mode
	if(mode == 0) then
	if(btnp(0) or btnp(1) or btnp(4) or btnp(5)) reset()

	--p1 victory
elseif(mode == 2) then
		if(btnp(0) or btnp(1) or btnp(4) or btnp(5)) reset() --replay

	--p2 victory
elseif(mode == 3) then
		if(btnp(0) or btnp(1) or btnp(4) or btnp(5)) reset() --replay


	--in game mode
elseif(mode == 1) then
		--game logic
		p1.x += speed
		p2.x -= speed
		if(p2.x <= p1.x + 8)then
			--collision, so gameover
			if(findWinner() == true) then
				mode = 2
			else
				mode = 3
			end

		end

		if(btnp(4)) then
			p1.spr -= 1
			if(p1.spr < 1) p1.spr = 3
			if(p1.spr == p2.spr) p1.spr -= 1
			if(p1.spr < 1) p1.spr = 3
		end

		if(btnp(5)) then
			p1.spr += 1
			if(p1.spr > 3) p1.spr = 1
			if(p1.spr == p2.spr) p1.spr += 1
			if(p1.spr > 3) p1.spr = 1
		end

		if(btnp(0)) then
			p2.spr -= 1
			if(p2.spr < 1) p2.spr = 3
			if(p2.spr == p1.spr) p2.spr -= 1
			if(p2.spr < 1) p2.spr = 3
		end

		if(btnp(1)) then
			p2.spr += 1
			if(p2.spr > 3) p2.spr = 1
			if(p2.spr == p1.spr) p2.spr += 1
			if(p2.spr > 3) p2.spr = 1
		end
	end



end


function _draw()
local p1 = getp1();
local p2 = getp2();
	cls()
	if(mode == 0) then
map(6,0,32,10,8,2)
map(0,0,52,32,3,3)
print("each shape beats the next",0,63,8)
print("change shape:",0,71)
print("p1: z and x.",0,79,9)
print("p2: left and right arrow",0,85,10)
print("press any of these keys to start",0,93,12)

	end
	if(mode == 1) then
		drawplayers()
		map(0,0,52,32,3,3)
		print("p1 score:" .. p1.score, 0,0,12)
		print("p1 score:" .. p1.score, 0,8,11)
	end
	if(mode == 2) then
		print("player 1 winner",0,0,12)
		print("press z, x, left or right",0,8)
		print("to try again",0,16)
	end
	if(mode == 3) then
		print("player 2 winner",0,0,11)
		print("press z, x, left or right",0,8)
		print("to try again",0,16)
	end
end
-->8
--enviroment

-->8
--utility

function drawplayers()
	for i=1,count(players) do
		spr(players[i].spr, players[i].x, players[i].y)

	end
end
--returns true if p1 is winner and false if p2 is winner
function findWinner()
	local p1 = getp1()
	local p2 = getp2()
	if(p1.spr == 1) then
		if(p2.spr == 2) return false
		if(p2.spr == 3) return true
	elseif(p1.spr == 2) then
		if(p2.spr == 1)  return true
		if(p2.spr == 3) return false
	elseif(p1.spr == 3) then
		if(p2.spr == 1) return false
		if(p2.spr == 2)  return true
	end
end

function reset()
	local p1 = getp1()
	local p2 = getp2()
	p1.spr = 1
	p1.x = 0
	p1.y = 63
	p1.score = 0

	p2.spr = 2
	p2.x = 119
	p2.y = 63
	p2.score = 0
	speed = 0.5
	mode = 1
end

-->8
--player

function getp1()
	return players[1]
end

function getp2()
	return players[2]
end
__gfx__
00000000888888880000000000bbbb00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000088888888000000000bbbbbb0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0070070088888888000cc000bbbbbbbb000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000770008888888800cccc00bbbbbbbb000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000770008888888800cccc00bbbbbbbb000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00700700888888880cccccc0bbbbbbbb000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000888888880cccccc00bbbbbb0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000088888888cccccccc00bbbb00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00007777000000007000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000077000000000700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000707007000000070000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00007007070000000007000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00070000777777770000700700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00700000070000000000070700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
07000000007000000000007700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
70000000000000000000777700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000008a0000088000000000000000000000888888000888888888800000000000000000000000000
000000000000000000000000000000000000000000000000000008a000089a800008900a80000000008aaaaaa000aaaa89aaaa00000000000000000000000000
000000000000000000000000000000000000000000000000000008a0008900a80008900a8000000008a000000000000089000000000000000000000000000000
000000000000000000000000000000000000000000000000000008a0008900a80008900a800000008a0000000000000089000000000000000000000000000000
000000000000000000000000000000000000000000000000000008a0008900a80008900a800000008a0000000000000089000000000000000000000000000000
000000000000000000000000000000000000000000000000000008a0008900a80008900a800000008a0000000000000089000000000000000000000000000000
000000000000000000000000000000000000000000000000000008a0008900a80008900a800000008a0000000000000089000000000000000000000000000000
000000000000000000000000000000000000000000000000000008a0008900a80008900a800000008a0000000000000089000000000000000000000000000000
000000000000000000000000000000000000000000000000000008a0008900a80008900a8000000008a000000000000089000000000000000000000000000000
000000000000000000000000000000000000000000000000000008a0008900a80008900a80000000008a00000000000089000000000000000000000000000000
000000000000000000000000000000000000000000000000000008a0008900a80008900a800000000098a0000000000089000000000000000000000000000000
000000000000000000000000000000000000000000000000000088a0008900a80008900a8000000000098a000000000089000000000000000000000000000000
00000000000000000000000000000000000000000000000000008a00008900a80008900a80000000000980000000000089000000000000000000000000000000
00000000000000000000000000000000000000000000000000088a00008900a80008900a80000000000980000000000089000000000000000000000000000000
0000000000000000000000000000000000000000000008888888a00000089a80000089a800009999999800000000000089000000000000000000000000000000
00000000000000000000000000000000000000000000099999990000000088000000088000008888888000000000000089000000000000000000000000000000
__map__
00010000000000464748494a4b4c000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
10001200000055565758595a5b5c000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0211030000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
